# TeachAI Visual Architecture Diagrams

## 1. ğŸ”„ Complete Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        USER INTERACTION                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Upload Document  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND PROCESSING                          â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1. File Uploadâ”‚â”€â”€â”€â–¶â”‚ 2. Text Extractâ”‚â”€â”€â–¶â”‚ 3. AI Processâ”‚  â”‚
â”‚  â”‚   Firebase    â”‚    â”‚   PDF/DOCX/TXT â”‚   â”‚   OpenAI API â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                     â”‚          â”‚
â”‚                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚                                          â”‚  4. Structure    â”‚ â”‚
â”‚                                          â”‚  - Categorize    â”‚ â”‚
â”‚                                          â”‚  - Extract Tags  â”‚ â”‚
â”‚                                          â”‚  - Add Metadata  â”‚ â”‚
â”‚                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                     â”‚          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              5. DUAL STORAGE SYSTEM                      â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚  Firebase Storage   â”‚      â”‚   Memory Cache       â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  (Persistent)       â”‚â—€â”€â”€â”€â”€â–¶â”‚   (Fast Access)      â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                     â”‚      â”‚                      â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ TeachAI/           â”‚      â”‚ documentHistory[]    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€ uploads/      â”‚      â”‚   [{doc1}, {doc2}]   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€ documents/    â”‚      â”‚                      â”‚  â”‚ â”‚
â”‚  â”‚  â”‚   â””â”€ metadata/     â”‚      â”‚   Synced on:         â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                     â”‚      â”‚   - Server start     â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   - Upload           â”‚  â”‚ â”‚
â”‚  â”‚                                â”‚   - Delete           â”‚  â”‚ â”‚
â”‚  â”‚                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      6. RETRIEVAL & CHAT                       â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ GET Request  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Return from     â”‚               â”‚
â”‚  â”‚ /api/docs    â”‚          â”‚ Memory Cache    â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ AI Chat      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Build Context   â”‚               â”‚
â”‚  â”‚ Single Mode  â”‚          â”‚ + OpenAI Query  â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ AI Chat      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Load ALL Docs   â”‚               â”‚
â”‚  â”‚ All Mode     â”‚          â”‚ + OpenAI Search â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 2. ğŸ“Š Document Data Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     DOCUMENT OBJECT                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  success: true                                             â”‚
â”‚  status: "processed"                                        â”‚
â”‚  category: "Automotive"  â—€â”€â”€ AUTO-CATEGORIZED              â”‚
â”‚  tags: ["cost", "manufacturing"]  â—€â”€â”€ EXTRACTED FROM TOPICSâ”‚
â”‚                                                             â”‚
â”‚  document: {                                               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚    â”‚         METADATA                        â”‚            â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚
â”‚    â”‚ id: "doc_1766273014198_rku3hipqo"      â”‚            â”‚
â”‚    â”‚ filename: "automotive_costs.txt"        â”‚            â”‚
â”‚    â”‚ size: 20427 bytes                       â”‚            â”‚
â”‚    â”‚ uploadDate: "2025-12-20T23:23:41.842Z" â”‚            â”‚
â”‚    â”‚ firebaseUrl: "https://storage..."       â”‚            â”‚
â”‚    â”‚ firebasePath: "TeachAI/uploads/..."     â”‚            â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                             â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚    â”‚         AI ANALYSIS                     â”‚            â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚
â”‚    â”‚ summary: {                              â”‚            â”‚
â”‚    â”‚   text: "Reducing manufacturing..."     â”‚â—€â”€â”€ OpenAI  â”‚
â”‚    â”‚   confidence: 0.95                      â”‚            â”‚
â”‚    â”‚   needsReview: false                    â”‚            â”‚
â”‚    â”‚ }                                       â”‚            â”‚
â”‚    â”‚                                         â”‚            â”‚
â”‚    â”‚ topics: {                               â”‚            â”‚
â”‚    â”‚   items: [                              â”‚â—€â”€â”€ OpenAI  â”‚
â”‚    â”‚     "Cost reduction",                   â”‚            â”‚
â”‚    â”‚     "Lean methodologies"                â”‚            â”‚
â”‚    â”‚   ]                                     â”‚            â”‚
â”‚    â”‚   confidence: 0.88                      â”‚            â”‚
â”‚    â”‚ }                                       â”‚            â”‚
â”‚    â”‚                                         â”‚            â”‚
â”‚    â”‚ entities: {                             â”‚            â”‚
â”‚    â”‚   items: [                              â”‚â—€â”€â”€ OpenAI  â”‚
â”‚    â”‚     {name: "Toyota", type: "org"}       â”‚            â”‚
â”‚    â”‚   ]                                     â”‚            â”‚
â”‚    â”‚   confidence: 0.6                       â”‚            â”‚
â”‚    â”‚   needsReview: true  â—€â”€â”€ LOW CONFIDENCE â”‚            â”‚
â”‚    â”‚ }                                       â”‚            â”‚
â”‚    â”‚                                         â”‚            â”‚
â”‚    â”‚ sentiment: {                            â”‚            â”‚
â”‚    â”‚   value: "neutral"                      â”‚â—€â”€â”€ OpenAI  â”‚
â”‚    â”‚   confidence: 0.8                       â”‚            â”‚
â”‚    â”‚ }                                       â”‚            â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                             â”‚
â”‚    processingTime: 7213ms                                  â”‚
â”‚    vectorized: true                                        â”‚
â”‚  }                                                          â”‚
â”‚                                                             â”‚
â”‚  createdAt: "2025-12-20T23:23:41.842Z"                    â”‚
â”‚  updatedAt: "2025-12-20T23:23:41.842Z"                    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 3. ğŸ¤– AI Processing Pipeline

```
                    TEXT INPUT
                        â”‚
                        â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚      OpenAI API Gateway       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚
        â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SUMMARY     â”‚         â”‚ TOPICS      â”‚
â”‚             â”‚         â”‚             â”‚
â”‚ gpt-4o-mini â”‚         â”‚ gpt-4o-mini â”‚
â”‚ max: 150    â”‚         â”‚ max: 100    â”‚
â”‚ tokens      â”‚         â”‚ tokens      â”‚
â”‚             â”‚         â”‚             â”‚
â”‚ Returns:    â”‚         â”‚ Returns:    â”‚
â”‚ "2-3 sent   â”‚         â”‚ JSON array  â”‚
â”‚  summary"   â”‚         â”‚ of topics   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚
        â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ENTITIES    â”‚         â”‚ SENTIMENT   â”‚
â”‚             â”‚         â”‚             â”‚
â”‚ gpt-4o-mini â”‚         â”‚ gpt-4o-mini â”‚
â”‚ max: 200    â”‚         â”‚ max: 10     â”‚
â”‚ tokens      â”‚         â”‚ tokens      â”‚
â”‚             â”‚         â”‚             â”‚
â”‚ Returns:    â”‚         â”‚ Returns:    â”‚
â”‚ [{name,     â”‚         â”‚ "positive"  â”‚
â”‚   type}]    â”‚         â”‚ "negative"  â”‚
â”‚             â”‚         â”‚ "neutral"   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   VECTOR EMBEDDINGS   â”‚
        â”‚                       â”‚
        â”‚ text-embedding-3-smallâ”‚
        â”‚                       â”‚
        â”‚ Chunks text into      â”‚
        â”‚ 1000 char pieces      â”‚
        â”‚                       â”‚
        â”‚ Each chunk â†’          â”‚
        â”‚ 1536-dimensional      â”‚
        â”‚ vector                â”‚
        â”‚                       â”‚
        â”‚ [0.023, -0.045, ...]  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   STRUCTURED OUTPUT   â”‚
        â”‚                       â”‚
        â”‚ {                     â”‚
        â”‚   summary,            â”‚
        â”‚   topics,             â”‚
        â”‚   entities,           â”‚
        â”‚   sentiment,          â”‚
        â”‚   chunks,             â”‚
        â”‚   confidence: 0.95    â”‚
        â”‚ }                     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 4. ğŸ’¬ AI Chat Query Flow

### Single Document Mode

```
User Question: "What are the main findings?"
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend: AIChat.jsx            â”‚
â”‚  Selected: "Cost Report.txt"     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼ POST /api/ai/ask
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend: aiController.js        â”‚
â”‚                                  â”‚
â”‚  Receives:                       â”‚
â”‚  {                               â”‚
â”‚    question: "...",              â”‚
â”‚    context: {                    â”‚
â”‚      mode: "single",             â”‚
â”‚      filename: "Cost Report.txt" â”‚
â”‚      summary: "...",             â”‚
â”‚      topics: [...],              â”‚
â”‚      entities: [...]             â”‚
â”‚    }                             â”‚
â”‚  }                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼ Build Prompt
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Prompt Construction             â”‚
â”‚                                  â”‚
â”‚  "You are analyzing:             â”‚
â”‚   Document: Cost Report.txt      â”‚
â”‚   Summary: [summary text]        â”‚
â”‚   Topics: [topics list]          â”‚
â”‚                                  â”‚
â”‚   User Question: What are the    â”‚
â”‚   main findings?                 â”‚
â”‚                                  â”‚
â”‚   Answer based on this document."â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼ OpenAI API Call
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OpenAI: gpt-3.5-turbo          â”‚
â”‚  Temperature: 0.7                â”‚
â”‚  Max Tokens: 600                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼ Response
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  "The main findings include:     â”‚
â”‚   1. Cost reduction of 15%       â”‚
â”‚   2. Improved efficiency...      â”‚
â”‚   3. Lean methodology success..." â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼ Return to Frontend
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Display in Chat Interface       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### All Documents Mode

```
User Question: "Which document talks about costs?"
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend: AIChat.jsx            â”‚
â”‚  Mode: All Documents             â”‚
â”‚  Category: Automotive (filtered) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼ Load ALL documents
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  documents = [                   â”‚
â”‚    {id, filename, summary, ...}, â”‚
â”‚    {id, filename, summary, ...}, â”‚
â”‚    {id, filename, summary, ...}  â”‚
â”‚  ]                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼ POST /api/ai/ask
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend: aiController.js        â”‚
â”‚                                  â”‚
â”‚  Receives:                       â”‚
â”‚  {                               â”‚
â”‚    question: "...",              â”‚
â”‚    context: {                    â”‚
â”‚      mode: "all",                â”‚
â”‚      documentCount: 3,           â”‚
â”‚      documents: [                â”‚
â”‚        {filename, summary, ...}, â”‚
â”‚        {filename, summary, ...}, â”‚
â”‚        {filename, summary, ...}  â”‚
â”‚      ]                           â”‚
â”‚    }                             â”‚
â”‚  }                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼ Build Multi-Doc Prompt
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  "You have access to 3 documents:â”‚
â”‚                                  â”‚
â”‚   Document 1: Cost Report.txt    â”‚
â”‚   Summary: Discusses 15% cost... â”‚
â”‚   Topics: Cost reduction, Lean   â”‚
â”‚                                  â”‚
â”‚   Document 2: Manufacturing.txt  â”‚
â”‚   Summary: Production efficiency â”‚
â”‚   Topics: Manufacturing, Quality â”‚
â”‚                                  â”‚
â”‚   Document 3: Budget Plan.txt    â”‚
â”‚   Summary: Q1 budget allocation  â”‚
â”‚   Topics: Budget, Planning       â”‚
â”‚                                  â”‚
â”‚   Question: Which document talks â”‚
â”‚   about costs?                   â”‚
â”‚                                  â”‚
â”‚   Search across ALL documents    â”‚
â”‚   and reference specific ones."  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼ OpenAI API Call
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OpenAI: gpt-3.5-turbo          â”‚
â”‚  Temperature: 0.7                â”‚
â”‚  Max Tokens: 600                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼ Response with References
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  "Cost Report.txt (Document 1)   â”‚
â”‚   discusses cost reduction       â”‚
â”‚   strategies achieving 15%       â”‚
â”‚   savings through Lean methods.  â”‚
â”‚                                  â”‚
â”‚   Budget Plan.txt (Document 3)   â”‚
â”‚   also mentions cost allocations â”‚
â”‚   for Q1 planning."              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼ Return to Frontend
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Display in Chat Interface       â”‚
â”‚  Shows answer with doc referencesâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 5. ğŸ—‚ï¸ Category Auto-Detection

```
Document Analysis Results
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Extract Topics        â”‚
â”‚  topics.items.join(' ')â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Pattern Matching                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                        â”‚
â”‚  "automotive", "vehicle", "car"        â”‚
â”‚          â†“                             â”‚
â”‚    ğŸš— AUTOMOTIVE                       â”‚
â”‚                                        â”‚
â”‚  "epa", "environment", "emission"      â”‚
â”‚          â†“                             â”‚
â”‚    ğŸŒ ENVIRONMENTAL                    â”‚
â”‚                                        â”‚
â”‚  "cost", "manufacturing", "production" â”‚
â”‚          â†“                             â”‚
â”‚    ğŸ­ MANUFACTURING                    â”‚
â”‚                                        â”‚
â”‚  "technology", "innovation"            â”‚
â”‚          â†“                             â”‚
â”‚    ğŸ’» TECHNOLOGY                       â”‚
â”‚                                        â”‚
â”‚  "policy", "regulation", "compliance"  â”‚
â”‚          â†“                             â”‚
â”‚    ğŸ“‹ POLICY & REGULATION              â”‚
â”‚                                        â”‚
â”‚  [default]                             â”‚
â”‚          â†“                             â”‚
â”‚    ğŸ“ GENERAL                          â”‚
â”‚                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 6. ğŸ” Search Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SEARCH CAPABILITIES                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  1ï¸âƒ£  KEYWORD SEARCH                            â”‚
â”‚     â””â”€ Search in: filename, summary, topics    â”‚
â”‚     â””â”€ Fast (memory-based)                     â”‚
â”‚     â””â”€ Exact/partial matches                   â”‚
â”‚                                                 â”‚
â”‚  2ï¸âƒ£  CATEGORY FILTER                           â”‚
â”‚     â””â”€ Filter by: Auto-detected categories     â”‚
â”‚     â””â”€ Instant (client-side)                   â”‚
â”‚     â””â”€ Organize documents                      â”‚
â”‚                                                 â”‚
â”‚  3ï¸âƒ£  SEMANTIC SEARCH (via AI)                  â”‚
â”‚     â””â”€ Search by: Meaning, not just keywords   â”‚
â”‚     â””â”€ Uses: Vector embeddings                 â”‚
â”‚     â””â”€ Finds: Conceptually similar content     â”‚
â”‚                                                 â”‚
â”‚  4ï¸âƒ£  AI-POWERED SEARCH                         â”‚
â”‚     â””â”€ Natural language queries                â”‚
â”‚     â””â”€ Understands: Context and intent         â”‚
â”‚     â””â”€ Returns: Synthesized answers            â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 7. ğŸ’¾ Storage Comparison

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  FIREBASE vs MEMORY                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ğŸ”¥ FIREBASE STORAGE                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ âœ… Persistent (survives restarts)          â”‚            â”‚
â”‚  â”‚ âœ… Scalable (unlimited storage)            â”‚            â”‚
â”‚  â”‚ âœ… Accessible from anywhere                â”‚            â”‚
â”‚  â”‚ âœ… Automatic backups                       â”‚            â”‚
â”‚  â”‚ âŒ Slower (network latency)                â”‚            â”‚
â”‚  â”‚ âŒ Costs money (but minimal)               â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                             â”‚
â”‚  ğŸ’¾ MEMORY CACHE                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ âœ… Fast (instant access)                   â”‚            â”‚
â”‚  â”‚ âœ… No network calls                        â”‚            â”‚
â”‚  â”‚ âœ… Free                                    â”‚            â”‚
â”‚  â”‚ âŒ Lost on restart                         â”‚            â”‚
â”‚  â”‚ âŒ Limited by RAM                          â”‚            â”‚
â”‚  â”‚ âŒ Single server only                      â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                             â”‚
â”‚  ğŸ”„ OUR APPROACH: BOTH                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ â€¢ Firebase = Source of Truth               â”‚            â”‚
â”‚  â”‚ â€¢ Memory = Fast Cache                      â”‚            â”‚
â”‚  â”‚ â€¢ Synced on startup                        â”‚            â”‚
â”‚  â”‚ â€¢ Best of both worlds                      â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 8. ğŸ“ˆ Data Flow Timeline

```
Time â†’

T=0ms      Upload starts
           â””â”€ User clicks upload

T=100ms    File received by backend
           â””â”€ Multer middleware

T=200ms    File saved to Firebase
           â””â”€ Original file stored

T=300ms    Text extraction begins
           â””â”€ PDF/DOCX â†’ Text

T=1000ms   OpenAI processing starts
           â”‚
           â”œâ”€ Summary (2s)
           â”œâ”€ Topics (1s)
           â”œâ”€ Entities (1s)
           â”œâ”€ Sentiment (0.5s)
           â””â”€ Embeddings (2s)

T=7000ms   AI processing complete
           â””â”€ All results received

T=7100ms   Auto-categorization
           â””â”€ Pattern matching on topics

T=7150ms   Tag extraction
           â””â”€ First 5 topics â†’ tags

T=7200ms   Save to Firebase Storage
           â””â”€ Metadata as JSON

T=7250ms   Add to memory cache
           â””â”€ Append to documentHistory[]

T=7300ms   Response sent to frontend
           â””â”€ Document available in chat

TOTAL: ~7.3 seconds
```

---

## ğŸ“ Key Takeaways

1. **Dual Storage**: Firebase (persistent) + Memory (fast)
2. **Structured Data**: Consistent JSON format
3. **AI Pipeline**: Multiple specialized models
4. **Auto-Organization**: Smart categorization
5. **Flexible Search**: Keyword, category, semantic, AI
6. **Scalable**: Can handle thousands of documents
7. **Maintainable**: Clear separation of concerns

---

**Created**: December 2025
**For**: TeachAI Technical Documentation
